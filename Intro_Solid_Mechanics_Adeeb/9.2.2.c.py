import sympy as sp
import numpy as np
from sympy import Matrix, simplify, diff, eye, det
display("Extension")
theta = sp.symbols("theta")
X1,X2,X3 = sp.symbols("X_1 X_2 X_3")
X = Matrix([X1,X2,X3])
a,b,c = sp.symbols("a b c")
ea,eb,ec,t = sp.symbols("epsilon_a epsilon_b epsilon_c t")
f0 = sp.symbols("f_0")
xe1 = (1+t*ea)*X1
xe2 = (1-t*eb)*X2
xe3 = (1-t*ec)*X3
xe = Matrix([xe1, xe2, xe3])
F = Matrix([[diff(i,j) for j in X] for i in xe])
display("F =",F)
Elagrange = simplify(1/2*(F.T*F-eye(3)))
display("Lagrange Strain =",Elagrange)
Elagrangedot = diff(Elagrange,t)
display("Lagrange Strain rate =",Elagrangedot)
Fdot = simplify(diff(F,t))
display("Fdot =",Fdot)
L = simplify(Fdot*F.inv())
display("Velocity gradient (L) =",L)
Dd = simplify(1/2*(L+L.T))
display("Symmetric part of L", Dd)
Cauchy = Matrix([[t*f0/(b*c*(1-t*eb)*(1-t*ec)),0,0],[0,0,0],[0,0,0]])
display("Cauchy =",Cauchy)
P = simplify(det(F)*Cauchy*F.T.inv())
display("First Piola =",P)
S = simplify(F.inv()*P)
display("Second Piola =",S)
e1 = sum([Cauchy[i]*Dd[i] for i in range(9)])
display("Cauchy",Cauchy,"Dd",Dd)
display("D and Cauchy are energy conjugates: dU/dt", simplify(e1))
e2 = sum([P[i]*Fdot[i] for i in range(9)])
display("P",P,"Fdot",Fdot)
display("P and Fdot are energy conjugates: dW/dt", simplify(e2))
e2 = sum([S[i]*Elagrangedot[i] for i in range(9)])
display("S",S,"E_Green",Elagrangedot)
display("S and E_Green are energy conjugates: dW/dt", simplify(e2))
display("Rotation")
xe = xe.subs({t:1})
Q = Matrix([[sp.cos(theta*(t-1)), sp.sin(theta*(t-1)),0],
            [-sp.sin(theta*(t-1)),sp.cos(theta*(t-1)), 0],
            [0,0,1]])
Q = Q.subs({theta:sp.pi/2})
display("Q =", Q)
x = Q*xe
F = Matrix([[diff(i,j) for j in X] for i in x])
display("F =",F)
Elagrange = simplify(1/2*(F.T*F-eye(3)))
display("Lagrange Strain =",Elagrange)
Elagrangedot = diff(Elagrange,t)
display("Lagrange Strain rate =",Elagrangedot)
Fdot = simplify(diff(F,t))
display("Fdot =",Fdot)
L = simplify(Fdot*F.inv())
display("Velocity gradient (L) =",L)
Dd = simplify(1/2*(L+L.T))
display("Symmetric part of L", Dd)
sigmalocal = Cauchy.subs({t:1})
Cauchy = simplify(Q*sigmalocal*Q.T)
display("Cauchy =",Cauchy)
P = simplify(det(F)*Cauchy*F.T.inv())
display("First Piola =",P)
S = simplify(F.inv()*P)
display("Second Piola =",S)
e1 = sum([Cauchy[i]*Dd[i] for i in range(9)])
display("Cauchy",Cauchy,"Dd",Dd)
display("D and Cauchy are energy conjugates: dU/dt", simplify(e1))
e2 = sum([P[i]*Fdot[i] for i in range(9)])
display("P",P,"Fdot",Fdot)
display("P and Fdot are energy conjugates: dW/dt", simplify(e2))
e2 = sum([S[i]*Elagrangedot[i] for i in range(9)])
display("S",S,"E_Green",Elagrangedot)
display("S and E_Green are energy conjugates: dW/dt", simplify(e2))
